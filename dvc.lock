schema: '2.0'
stages:
  prepare:
    cmd: python src/prepare.py data/STH-small.csv data/prepared
    deps:
    - path: src/prepare.py
      md5: 96bb2cf88a379b47c31aaefb06909a99
      size: 882
    params:
      params.yaml:
        prepare.weather:
          end-date: '2020-08-16'
          forecast-horizon: full
          latitude: 59.334591
          longitude: 18.06324
          model: NCEP_GFS
          reference-time-freq: 6H
          start-date: '2020-06-01'
          variables: Temperature, CloudCover
    outs:
    - path: data/prepared
      md5: ef6659c00fe6f545be8f726fd514b756
      size: 1661716
  featurize:
    cmd: python src/featurize.py data/prepared data/features
    deps:
    - path: data/prepared
      md5: ef6659c00fe6f545be8f726fd514b756
      size: 1661716
    - path: src/featurize.py
      md5: c270bd2f495e95f84a7823cdcbe54b7f
      size: 1078
    params:
      params.yaml:
        featurize.features:
        - cal_weekday
        - dow
    outs:
    - path: data/features
      md5: abd8b0d818fe835f2b81616b55d4f152
      size: 4714202
  train:
    cmd: python src/train.py data/features model.pkl
    deps:
    - path: data/features
      md5: abd8b0d818fe835f2b81616b55d4f152
      size: 4714202
    - path: src/train.py
      md5: c55f6ef47292fde7c0046894bb5868ee
      size: 1265
    params:
      params.yaml:
        train:
          alpha: 0.5
          bagging_fraction: 0.5
          bagging_freq: 5
          boosting: gbdt
          feature_fraction: 1.0
          lambda_l1: 0.0
          lambda_l2: 0.0
          learning_rate: 0.4
          max_bin: 255
          max_depth: 8
          max_leaves: 64
          min_data_in_leaf: 10
          num_threads: 1
          num_trees: 500
          objective: quantile
          verbose: -1
    outs:
    - path: model.pkl
      md5: 2cc7e62942f1f7a9e7482a720f4f4927
      size: 505129
